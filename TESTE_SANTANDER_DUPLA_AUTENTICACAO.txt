=============================================================================
TESTE SANTANDER PIX - DUPLA ESTRATÃ‰GIA DE AUTENTICAÃ‡ÃƒO
=============================================================================

ðŸ“Œ MUDANÃ‡AS APLICADAS:
1. Tenta primeiro com Basic Auth (padrÃ£o OAuth 2.0)
2. Se falhar, tenta com client_id e client_secret no body
3. Logs detalhados para debug

=============================================================================
COMANDOS PARA TESTAR
=============================================================================

# 1. Fazer upload do arquivo atualizado
# SantanderPixService.php â†’ /home/tocantinstransportewifi/htdocs/www.tocantinstransportewifi.com.br/app/Services/

# 2. No servidor:
cd /home/tocantinstransportewifi/htdocs/www.tocantinstransportewifi.com.br

# 3. Limpar cache
php artisan config:clear

# 4. Testar
php artisan santander:pix test

# 5. Ver os logs detalhados
tail -n 150 storage/logs/laravel.log | grep -A 5 "Tentando autenticaÃ§Ã£o"

=============================================================================
O QUE ESPERAR
=============================================================================

âœ… CENÃRIO 1: Basic Auth funciona
[2025-10-01 11:XX:XX] production.INFO: ðŸ” Tentando autenticaÃ§Ã£o (formato 1: Basic Auth)
[2025-10-01 11:XX:XX] production.INFO: âœ… Token OAuth 2.0 obtido com sucesso (Basic Auth)

âœ… CENÃRIO 2: Body params funciona
[2025-10-01 11:XX:XX] production.INFO: ðŸ” Tentando autenticaÃ§Ã£o (formato 1: Basic Auth)
[2025-10-01 11:XX:XX] production.WARNING: âš ï¸ Basic Auth falhou, tentando com credenciais no body
[2025-10-01 11:XX:XX] production.INFO: ðŸ” Tentando autenticaÃ§Ã£o (formato 2: Body params)
[2025-10-01 11:XX:XX] production.INFO: âœ… Token OAuth 2.0 obtido com sucesso (Body params)

âŒ CENÃRIO 3: Ambos falharam - PROBLEMA NAS CREDENCIAIS
[2025-10-01 11:XX:XX] production.ERROR: âŒ Ambas tentativas de autenticaÃ§Ã£o falharam

=============================================================================
SE AMBOS FALHAREM
=============================================================================

O problema pode ser:

1. âŒ CLIENT_ID ou CLIENT_SECRET incorretos
   - Verifique no portal do Santander
   - PeÃ§a ao Rafael para confirmar as credenciais
   
2. âŒ Certificado nÃ£o corresponde ao CLIENT_ID
   - O certificado .pem deve estar vinculado Ã  sua conta
   
3. âŒ Ambiente incorreto (sandbox vs production)
   - Se as credenciais sÃ£o de sandbox, mude para:
     SANTANDER_ENVIRONMENT=sandbox
   
4. âŒ Conta nÃ£o ativada no Santander
   - Entre em contato com o suporte do Santander

=============================================================================
TESTE RÃPIDO DAS CREDENCIAIS
=============================================================================

Execute no servidor para ver se as credenciais parecem corretas:

# Ver o tamanho das credenciais
php -r "require 'vendor/autoload.php'; \$app = require_once 'bootstrap/app.php'; \$app->make('Illuminate\Contracts\Console\Kernel')->bootstrap(); echo 'CLIENT_ID (len): ' . strlen(config('wifi.payment_gateways.pix.client_id')) . PHP_EOL; echo 'CLIENT_SECRET (len): ' . strlen(config('wifi.payment_gateways.pix.client_secret')) . PHP_EOL;"

Resultado esperado:
- CLIENT_ID: 30-50 caracteres
- CLIENT_SECRET: 16-64 caracteres

Se for muito diferente disso, pode estar errado!

=============================================================================
TESTE COM SANDBOX
=============================================================================

Se vocÃª tem credenciais de SANDBOX, teste com:

# Editar .env
nano .env

# Mudar:
SANTANDER_ENVIRONMENT=sandbox

# Salvar e testar
php artisan config:clear
php artisan santander:pix test

============================================================================= 