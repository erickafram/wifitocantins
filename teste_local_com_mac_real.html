<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste MAC Real - WiFi Tocantins</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 600px; 
            margin: 50px auto; 
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .mac-test {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            width: 100%;
        }
        button:hover { background: #45a049; }
        .result { 
            margin-top: 20px; 
            padding: 15px; 
            background: rgba(0,0,0,0.3); 
            border-radius: 8px; 
        }
        .success { border-left: 5px solid #4CAF50; }
        .error { border-left: 5px solid #f44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste MAC Real - Local</h1>
        
        <div class="mac-test">
            <h3>SEU MAC REAL DETECTADO:</h3>
            <p><strong>Wi-Fi:</strong> 5C:CD:5B:2F:B9:3F</p>
            <p><strong>IP Local:</strong> 192.168.0.14</p>
        </div>

        <h3>Testes Dispon√≠veis:</h3>
        
        <button onclick="testarMacViaUrl()">
            1. üîó Testar MAC via URL (?mac=5C:CD:5B:2F:B9:3F)
        </button>
        
        <button onclick="testarDeteccaoNormal()">
            2. üì± Testar Detec√ß√£o Normal (Mock)
        </button>
        
        <button onclick="simularProducao()">
            3. üöÄ Simular Ambiente Produ√ß√£o
        </button>

        <div id="resultado" class="result" style="display:none;"></div>
    </div>

    <script>
        // URL base (local para teste)
        const baseUrl = 'http://localhost:8000'; // ou a URL do seu servidor local

        async function testarMacViaUrl() {
            mostrarCarregando();
            
            try {
                // Testar com MAC real na URL
                const response = await fetch(`${baseUrl}/api/detect-device?mac=5C:CD:5B:2F:B9:3F`);
                const data = await response.json();
                
                mostrarResultado(
                    '‚úÖ TESTE MAC VIA URL', 
                    `MAC detectado: ${data.mac_address}<br>
                     IP: ${data.ip_address}<br>
                     Sucesso: ${data.mac_address === '5C:CD:5B:2F:B9:3F' ? 'SIM ‚úÖ' : 'N√ÉO ‚ùå'}`,
                    data.mac_address === '5C:CD:5B:2F:B9:3F'
                );
            } catch (error) {
                mostrarResultado('‚ùå ERRO', error.message, false);
            }
        }

        async function testarDeteccaoNormal() {
            mostrarCarregando();
            
            try {
                // Testar sem MAC na URL (deve gerar mock)
                const response = await fetch(`${baseUrl}/api/detect-device`);
                const data = await response.json();
                
                mostrarResultado(
                    'üì± TESTE DETEC√á√ÉO NORMAL', 
                    `MAC detectado: ${data.mac_address}<br>
                     IP: ${data.ip_address}<br>
                     Tipo: ${data.mac_address.startsWith('02:') ? 'Mock (esperado) üîß' : 'Real üéØ'}`,
                    true
                );
            } catch (error) {
                mostrarResultado('‚ùå ERRO', error.message, false);
            }
        }

        async function simularProducao() {
            mostrarCarregando();
            
            // Simular redirect do MikroTik
            const urlProducao = 'https://www.tocantinstransportewifi.com.br/?mac=5C:CD:5B:2F:B9:3F&source=mikrotik';
            
            mostrarResultado(
                'üöÄ SIMULA√á√ÉO PRODU√á√ÉO', 
                `URL de teste:<br>
                 <a href="${urlProducao}" target="_blank" style="color: #4CAF50; word-break: break-all;">
                 ${urlProducao}
                 </a><br><br>
                 üëÜ Clique para testar em produ√ß√£o real!<br>
                 (Abrir√° em nova aba)`,
                true
            );
        }

        function mostrarCarregando() {
            const resultado = document.getElementById('resultado');
            resultado.style.display = 'block';
            resultado.className = 'result';
            resultado.innerHTML = '‚è≥ Testando...';
        }

        function mostrarResultado(titulo, conteudo, sucesso) {
            const resultado = document.getElementById('resultado');
            resultado.style.display = 'block';
            resultado.className = `result ${sucesso ? 'success' : 'error'}`;
            resultado.innerHTML = `<h4>${titulo}</h4><p>${conteudo}</p>`;
        }

        // Auto-detectar quando carregar a p√°gina
        window.onload = function() {
            document.getElementById('resultado').style.display = 'block';
            document.getElementById('resultado').className = 'result success';
            document.getElementById('resultado').innerHTML = `
                <h4>‚ÑπÔ∏è INFORMA√á√ïES DO TESTE</h4>
                <p>üè† <strong>Ambiente:</strong> Local (${window.location.origin})<br>
                   üñ•Ô∏è <strong>Seu MAC:</strong> 5C:CD:5B:2F:B9:3F<br>
                   üåê <strong>Servidor Laravel:</strong> ${window.location.origin.includes('localhost') ? 'Local' : 'Produ√ß√£o'}<br><br>
                   üí° <strong>Nota:</strong> Em ambiente local, o sistema gerar√° MACs mock.<br>
                   Para teste real, use o bot√£o "Simular Produ√ß√£o".</p>
            `;
        };
    </script>
</body>
</html>
